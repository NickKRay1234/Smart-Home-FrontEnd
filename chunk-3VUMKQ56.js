import{a as F,b as L,c as N,d as z,e as I,f as R,g as T}from"./chunk-JTBRSHWV.js";import{a as U,d as D}from"./chunk-URSUDYYS.js";import{h as O,j as A,k as B,q as V}from"./chunk-MTZZGECX.js";import{$a as g,Da as s,Ea as S,Qa as p,T as u,V as M,Va as f,Za as t,_a as n,cb as k,da as c,db as E,ea as d,eb as h,ib as r,jb as x,lb as C,mb as _,na as y,nb as v,pb as P}from"./chunk-DXEYFIYH.js";import{d as w}from"./chunk-4CLCTAJ7.js";function j(a,i){if(a&1&&(t(0,"div",8),r(1),n()),a&2){let e=h();s(),x(e.errorMessage)}}function Z(a,i){if(a&1&&(t(0,"div",8),r(1),n()),a&2){let e=h();s(),x(e.errorMessage)}}var W=class a{constructor(i){this._ngZone=i;let e=this.activatedRoute.snapshot.queryParams.returnUrl;e&&(this.returnUrl=e),this.model={email:"",password:"",clientURI:""}}authService=u(D);cookies=u(U);router=u(A);activatedRoute=u(O);returnUrl="";model;errorMessage;showError=!1;ngOnInit(){google.accounts.id.initialize({client_id:V.clientId,callback:this.handleCredentialResponse.bind(this),auto_select:!1,cancel_on_tap_outside:!0,use_fedcm_for_prompt:!0}),google.accounts.id.renderButton(document.getElementById("google"),{type:"icon",theme:"outline",size:"medium",shape:"pill"}),google.accounts.id.prompt(i=>{})}onFormSubmit(){this.authService.isExternalAuth=!1,this.authService.login(this.model).subscribe({next:i=>{(i.isAuthSuccessful=!1)&&(this.showError=!0,this.errorMessage=i.errorMessage),this.cookies.set("Authorization",`Bearer ${i.token}`,void 0,"/",void 0,!0,"Strict"),this.authService.getUserInfo().subscribe({next:e=>{this.authService.setStorageUser(e)}}),this.router.navigateByUrl(this.returnUrl)}})}handleCredentialResponse(i){return w(this,null,function*(){this.authService.externalLogin({idToken:i.credential,provider:"google"}).subscribe({next:e=>{(e.isAuthSuccessful=!1)&&(this.showError=!0,this.errorMessage=e.errorMessage),this.cookies.set("Authorization",`Bearer ${e.token}`,void 0,"/",void 0,!0,"Strict"),this.authService.sendAuthStateChangeNotification(e.isAuthSuccessful),this.authService.getUserInfo().subscribe({next:o=>{this.authService.setStorageUser(o)}}),this._ngZone.run(()=>{this.router.navigateByUrl(this.returnUrl)})}})})}static \u0275fac=function(e){return new(e||a)(S(y))};static \u0275cmp=M({type:a,selectors:[["app-login"]],standalone:!0,features:[P],decls:30,vars:4,consts:[["form","ngForm"],[1,"wrapper"],[1,"frame"],["href","/",1,"close-icon"],["src","assets/images/png/tabler-icon-x.png","alt","Close"],[1,"container"],[1,"login-form"],["type","email","name","email","id","email","placeholder","\u0415\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u0430 \u043F\u043E\u0448\u0442\u0430",3,"ngModelChange","ngModel"],[1,"alert"],["type","password","name","pwd","id","pwd","placeholder","\u041F\u0430\u0440\u043E\u043B\u044C",3,"ngModelChange","ngModel"],[1,"login",3,"click"],[1,"social"],[1,"social-icons"],["href","https://facebook.com",1,"facebook"],["src","assets/images/png/facebook.png","alt","facebook"],["id","google"],[1,"redirect"],[1,"register"],["routerLink","../register"],["href","#",1,"restore"]],template:function(e,o){if(e&1){let m=k();t(0,"div",1)(1,"div",2)(2,"a",3),g(3,"img",4),n(),t(4,"h2"),r(5,"\u0412\u0445\u0456\u0434"),n(),t(6,"div",5)(7,"form",6,0)(9,"input",7),v("ngModelChange",function(l){return c(m),_(o.model.email,l)||(o.model.email=l),d(l)}),n(),p(10,j,2,1,"div",8),t(11,"input",9),v("ngModelChange",function(l){return c(m),_(o.model.password,l)||(o.model.password=l),d(l)}),n(),p(12,Z,2,1,"div",8),t(13,"button",10),E("click",function(){return c(m),d(o.onFormSubmit())}),r(14,"\u0423\u0432\u0456\u0439\u0442\u0438"),n()(),t(15,"div",11)(16,"h4"),r(17,"\u0410\u0431\u043E \u0443\u0432\u0456\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437"),n(),t(18,"div",12)(19,"a",13),g(20,"img",14),n(),g(21,"div",15),n()(),t(22,"div",16)(23,"div",17)(24,"a",18),r(25,"\u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0432\u0430\u0442\u0438\u0441\u044F"),n()(),t(26,"h6"),r(27," \u0417\u0430\u0431\u0443\u043B\u0438 \u043F\u0430\u0440\u043E\u043B\u044C? "),t(28,"a",19),r(29,"\u0412\u0456\u0434\u043D\u043E\u0432\u0438\u0442\u0438"),n()()()()()()}e&2&&(s(9),C("ngModel",o.model.email),s(),f(o.showError?10:-1),s(),C("ngModel",o.model.password),s(),f(o.showError?12:-1))},dependencies:[T,R,F,L,N,I,z,B],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}.wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.frame[_ngcontent-%COMP%]{width:400px;position:relative;border-radius:20px;background:#fff;margin:auto;padding:5px;box-shadow:0 1px 2px #0000004d,0 1px 3px 1px #00000026}.close-icon[_ngcontent-%COMP%]{width:24px;height:24px;position:absolute;top:20px;right:20px;flex-shrink:0;float:right}h2[_ngcontent-%COMP%]{margin-top:44px;margin-bottom:20px;color:var(--blck, #393939);font-family:Jura;font-size:26px;font-style:normal;font-weight:600;line-height:normal;text-align:center}.container[_ngcontent-%COMP%]{display:flex;width:300px;flex-direction:column;align-items:center;gap:40px;margin:auto}.login-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;align-self:stretch}input[_ngcontent-%COMP%]{display:flex;height:60px;padding:0 32px;align-items:center;align-self:stretch;border-radius:61px;border:none;background:var(--B4, #E6F0F0);width:100%;box-sizing:border-box}input[_ngcontent-%COMP%]::placeholder{color:var(--blck, #393939);font-family:Tenor Sans;font-size:14px;font-style:normal;font-weight:400;line-height:normal}.login[_ngcontent-%COMP%]{padding:10px 20px;border-radius:100px;border:none;background:var(--B1, #AFC1E7);cursor:pointer;box-shadow:0 1px 2px #0000004d,0 1px 3px 1px #00000026}.social[_ngcontent-%COMP%]{display:flex;width:123px;flex-direction:column;align-items:center;gap:20px}h4[_ngcontent-%COMP%]{align-self:stretch;color:var(--blck, #393939);font-family:Tenor Sans;font-size:14px;font-style:normal;font-weight:400;line-height:normal}.social-icons[_ngcontent-%COMP%]{display:flex;width:104px;justify-content:space-between;align-items:center}.facebook[_ngcontent-%COMP%]{width:32px;height:32px;flex-shrink:0}.google[_ngcontent-%COMP%]{width:31.36px;height:32px;flex-shrink:0}.redirect[_ngcontent-%COMP%]{display:flex;width:185px;flex-direction:column;align-items:center;gap:20px}.register[_ngcontent-%COMP%]{display:flex;padding:12px 24px;justify-content:center;align-items:center;gap:10px;align-self:stretch;border-radius:44px;border:2px dashed var(--B1, #AFC1E7)}a[_ngcontent-%COMP%], button[_ngcontent-%COMP%] {color:var(--blck, #393939);font-family:Tenor Sans;font-size:14px;font-style:normal;font-weight:400;line-height:normal;text-decoration:none}h6[_ngcontent-%COMP%]{color:var(--G1, #91A0A5);text-align:center;font-family:Tenor Sans;font-size:14px;font-style:normal;font-weight:400;line-height:normal;align-self:stretch}.restore[_ngcontent-%COMP%]{color:var(--B1, #AFC1E7);font-family:Tenor Sans;font-size:14px;font-style:normal;font-weight:400;line-height:normal;text-decoration:none}.alert[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{background-color:#fed3d3;color:#820000;padding:1rem;margin-bottom:1rem}"]})};export{W as LoginComponent};
